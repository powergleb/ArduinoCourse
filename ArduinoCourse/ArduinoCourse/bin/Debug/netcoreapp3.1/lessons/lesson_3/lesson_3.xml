<Lesson>
  <Title>Урок 3. Цифровые контакты ввода-вывода шиотно-импульсная модуляция</Title>
  <Theories>
    <Theory>
      <Title>3.1) Список деталей</Title>
      <Text>Для повторения примеров главы понадобятся следующие детали:
• плата Arduino Uno;
• макетная плата;
• перемычки;
• 1 резистор номиналом 10 кОм;
• 3 резистора номиналом 220 Ом;
• кабель USB;
• кнопка;
• одноцветный светодиод 5 мм;
• RGB-светодиод 5 мм с общим катодом.
У большинства плат Arduino нет аналоговых выходов, но их можно эмулировать с помощью широтно-импульсной модуляции (ШИМ).
Далее мы расскажем, как сформировать ШИМ-сигнал.
Прочитав главу, вы сможете создать ночник на RGB-светодиоде.
Проект с мигающим светодиодом, рассмотренный в предыдущей главе, скорее игрушка, чем полезное устройство.
Действительно привлекательной для разработчиков делает платформу Arduino наличие контактов ввода-вывода.
К плате можно подключить, например, геркон, и при открытии двери проигрывать какую-либо мелодию или создать электронный сейф, или несложный музыкальный инструмент.
В этом уроке вы приступите к разработке новых проектов: познакомитесь с возможностями цифровых входов Arduino, узнаете о подтягивающих (pull-up) и стягивающих (pull-down) резисторах и научитесь управлять цифровыми выходами.</Text>
      <Pics />
    </Theory>
    <Theory>
      <Title>3.2) Цифровые контакты</Title>
      <Text>В главе 2 вы узнали, как заставить мигать светодиод, подключенный к цифровому контакту. Продолжим изучать возможности цифровых выходов Arduino и рассмотрим следующие темы:
• конфигурирование назначения цифровых выводов;
• подключение внешних компонентов;
• новые концепции программирования циклов и констант;
• различие между цифровыми и аналоговыми выходами;
• широтно-импульсная модуляция (ШИМ).</Text>
      <Pics />
    </Theory>
    <Theory>
      <Title>3.3) Подключение внешнего светодиода</Title>
      <Text>Мигающий светодиод из предыдущего примера был встроен в плату Arduino.
Теперь настало время выйти за пределы платы и соединить ее контакт 9 с внешним светодиодом.
Этот простой пример поможет вам понять, как собирать более сложные внешние цепи, описанные в следующих уроках.
Более того, контакт 9 Arduino позволяет формировать сигнал широтно-импульсной модуляции, что мы используем далее в этом уроке.
Рассмотрим, что такое макетная плата и как эффективно использовать ее для проектов из этой книги. Макетная плата - удобный инструмент для экспериментов, позволяющий легко собирать простые схемы без изготовления печатных плат и пайки.
С двух сторон по всей длине макетной платы расположены красные и синие
отверстия. Все красные отверстия соединены между собой и служат, как правило, для подачи питания. Для большинства проектов из этой книги это +5 В.
Все синие отверстия тоже электрически соединены друг с другом и играют роль шины заземления.
Каждые пять отверстий, расположенных вертикальными рядами, также соединены друг с другом.
Посередине есть свободное место для удобства установки компонентов на макетной плате. Электрические соединения отверстий показаны на рисунке утолщенными линиями.
Шина питания Шина заземления (общая шина)
Шина питания Шина заземления (общая шина)
Область для установки элементов</Text>
      <Pics>
        <Pic>\lessons\lesson_3\pic\pic3.1.jpg</Pic>
      </Pics>
    </Theory>
    <Theory>
      <Title>3.4) Подсоединение светодиодов</Title>
      <Text>Светодиоды почти наверняка будут одними из наиболее часто используемых деталей в проектах из данной книги.
Подключая светодиоды, необходимо соблюдать правильную полярность. Положительный вывод светодиода называется анодом, отрицательный - катодом.
Определить назначение контактов светодиода можно визуально: вывод катода короче, чем анода.
Ток через светодиод течет только в одном направлении: от анода к катоду.
Поскольку ток протекает от положительного полюса к отрицательному, анод светодиода следует подключить к источнику тока (цифровой выход +5 В), а катод к земле.
Резистор может быть подключен последовательно с любым из выводов светодиода.
Полярность подключения для резисторов не важна.
Подключать светодиод к контакту 9 Arduino нужно последовательно с резистором, который выступает в качестве ограничителя тока.
Чем больше сопротивление резистора, тем сильнее он ограничивает ток.
В этом примере мы применим резистор номиналом 220 Ом.
Монтажная схема изображена на рисунке.</Text>
      <Pics>
        <Pic>\lessons\lesson_3\pic\pic3.2.jpg</Pic>
      </Pics>
    </Theory>
    <Theory>
      <Title>3.5.1) Закон Ома и формула для расчета мощности, теория</Title>
      <Text>Самая главная формула для любого инженера-электрика - это закон Ома, который определяет соотношение между напряжением (измеряется в вольтах), током (измеряется в амперах) и сопротивлением (измеряется в Омах) в цепи.
Схема представляет собой замкнутый контур с источником электрической энергии ( например, батареей 9 В) и нагрузкой (чем-то, что расходует энергию, как светодиод).
Прежде всего, важно понять физический смысл каждого термина:
• напряжение представляет собой разность электрических потенциалов между двумя точками;
• ток течет от точки с более высокой потенциальной энергией, чтобы снизить потенциальную энергию.
Пользуясь аналогией, электрический ток можно представить как поток воды, а напряжение - как высоту перепада.
Вода (или ток) всегда течет из точки с большей высотой (более высокое напряжение) к точке с меньшей высотой (или более низкому напряжению).
Ток, как вода в реке, всегда будет идти по пути наименьшего сопротивления в цепи;
по аналогии сопротивление является отверстием для протекания тока.
Когда вода (ток) течет через узкую трубу, за одинаковое количество времени проходит меньшее количество, чем через широкую трубу.
Узкая труба эквивалентна большему сопротивлению, потому что вода будет течь медленнее.
Широкая труба эквивалентна малому сопротивлению, потому что вода (ток) может течь быстрее.
Закон Ома определяется следующим образом:
U = I·R, где U - напряжение в вольтах; I - ток в амперах; R - сопротивление в омах.</Text>
      <Pics />
    </Theory>
    <Theory>
      <Title>3.5.2) Закон Ома и формула для расчета мощности, практика</Title>
      <Text>В электрической цепи каждый компонент обладает некоторым сопротивлением, что снижает напряжение.
Закон Ома очень удобен для подбора значения резистора, подкточаемого последовательно со светодиодом.
Светодиоды характеризуются определенной величиной падения напряжения и заданным значением рабочего тока.
Чем больше ток через светодиод (не превышая максимально допустимого), тем ярче он светится.
Для наиболее распространенных светодиодов максимальный ток равен 20 мА.
Типовое значение падения напряжения для светодиода составляет около 2 в.
Рассмотрим схему, изображенную на рисунке, и применим закон Ома для подбора резистора R1.
Предположим, что LED 1 - стандартный светодиод с прямым током 20 мА и падением напряжения 2 В.
Напряжение питания 5 В должно перераспределиться между светодиодом и резистором.
Поскольку доля светодиода составляет 2 В, оставшиеся 3 В должны быть приложены к резистору.
Зная максимальное значение прямого тока через светодиод (20 мА), можно найти номинал резистора:
R = U/I= 3/0,02 = 150 Ом.
Таким образом, при сопротивлении резистора 150 Ом через него и светодиод протекает ток 20 мА.
По мере увеличения сопротивления ток будет уменьшаться.
Резистор 220 Ом обеспечивает достаточную яркость свечения светодиода, к тому же этот номинал очень распространен.
Еще одно важное соотношение - формула для расчета мощности, которая показывает, сколько ватт рассеивается на каждом компоненте.
Увеличение мощности рассеивания связано с ростом тепловыделения прибора.
Для каждого компонента, как правило, задается максимально допустимая мощность.
Максимальная мощность резистора в нашем примере равна 0,125 Вт.
Формула для расчета мощности выглядит следующим образом:
Р = U·I, где Р - мощность, Вт; U- напряжение, В; I - сила тока, А.
Для резистора из схемы на рис. 2.3 при падении напряжения 3 В и силе тока 20 мА мощность равна
Р = 3·0,02 = 0,06 Вт.
Поскольку 60 мВт меньше 0,125 Вт = 125 мВт, следовательно, данный резистор не перегреется.</Text>
      <Pics>
        <Pic>\lessons\lesson_3\pic\pic3.3.jpg</Pic>
      </Pics>
    </Theory>
    <Theory>
      <Title>3.6.1) Программирование цифровых выводов</Title>
      <Text>По умолчанию все внешние контакты Arduino сконфигурированы как входы. 
Если необходимо использовать контакт Arduino как выход, нужно его переконфигурировать, подав соответствующую команду микроконтроллеру.
Каждая программа для Arduino должна включать две обязательные функции:
setup() И loop().
В уроке 2 уже упоминалось, что функция setup() запускается один раз в начале программы, а loop() работает как цикл. Поскольку каждый контакт обычно конфигурируется в программе один раз, логично делать это в теле функции setup().
Для начала напишем простую программу, которая при запуске сконфигурирует контакт 9 как выход.
В программе будут еще две функции: pinMode() - для конфигурации контакта и digitalWrite() - для установки значения HIGH (5 В) на этом контакте (листинг 3.1 далее).</Text>
      <Pics />
    </Theory>
    <Theory>
      <Title>3.6.2) Листинг 3.1. Пример конфигурации</Title>
      <Text>const int LED = 9; // Константа - номер контакта светодиода
void setup()
{
	pinMode (LED, OUTPUT); // Конфигурируем контакт светодиода как выход
	digitalWrite(LED, HIGH); // Устанавливаем значение HIGH на выходе
}
void loop()
{
	// В цикле ничего не выполняем
}</Text>
      <Pics />
    </Theory>
    <Theory>
      <Title>3.6.3) О константах и инструкция</Title>
      <Text>Соберите схему, как показано на рисунке, и загрузите код листинга 3.1 в плату Arduino. 
Обратите внимание, что в этой программе использовал оператор инициализации константы перед определением значения контакта Arduino.
Обычно для хранения значений, которые могут изменяться во время выполнения программы, предназначены переменные.
Поставив оператор const до объявления переменной, вы говорите компилятору, что это переменная "только для чтения" и она не будет изменяться во время выполнения программы.
Всем экземплярам переменной LED в программе будет присвоено значение 9.
В виде констант рекомендуется определять значения, которые не будут меняться при выполнении программы.
Далее в некоторых примерах этой главы встретится иная ситуация: значения, которые могут изменяться при выполнении программы.
При объявлении любой переменной необходимо указать ее тип. В нашем случае это целое число (номера контактов всегда будут целыми числами).
Теперь попробуйте изменить программу из главы 2, добавив функцию digitalWrite() и введя задержку в цикле loop().
Экспериментируя со значениями задержки, можно создавать различные эффекты мигания.</Text>
      <Pics>
        <Pic>\lessons\lesson_3\pic\pic3.2.jpg</Pic>
      </Pics>
    </Theory>    
    <Theory>
      <Title>Итоги</Title>
      <Text>В этом уроке вы узнали о следующем:
•Как работать с макетной платой.
•Как выбрать резистор для ограничения тока светодиода.
•Как подключить внешний светодиод к плате Arduino.
•Как использовать ШИМ, как замену аналогового вывода.
•Как считывать состояние кнопки.
•Как подавить дребезг кнопки.
•Для чего нужны подтягивающий и стягивающий резисторы.</Text>
      <Pics />
    </Theory>
  </Theories>
  <Tests>
    <Test>
      <Title>test</Title>
      <Pics />
      <Text>test</Text>
      <Variants>
        <Variant>False1</Variant>
        <Variant>False2</Variant>
        <Variant>True</Variant>
        <Variant>False3</Variant>
      </Variants>
      <Answer>2</Answer>
    </Test>
  </Tests>
</Lesson>